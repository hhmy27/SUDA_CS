[TOC]

# 13年真题答案

## DS

### 1 邻接矩阵 

```c
//顶点数
const int maxn;	
//邻接矩阵，其中值Graph[i][j]=-1表示不可达，Graph[i][j]=n表示i到j的距离为n
int Graph[maxn][maxn];
```

### 2 Dijkstra算法的思想

Dijkstra用于解决图的单源最短路径问题，给定一个起点S，可以通过Dijkstra算法计算出起点S到图中剩余点的最短距离。

思想：给定一个起点S，维护一个集合D，$D(i)=j$表示S到i点的距离为j。S到D中的点都是最短距离，每次从未加入D集合中的点集中寻找一个当前距离最短的点u，加入到集合D中，同时优化集合D，也就是如果集合D中的点经过u达到的距离比原来D集合中的距离要小，则更新这个点在集合中的值。

正确性证明：生成一个均匀分布的网络，然后对算法进行测试，将每对顶点对之间的最短路径绘制成图，最后应该得到的是一幅完整的栅格图片，如果没有孤立点，则说明该算法正确

### 2 hash大题

3. hash，线性探测再散列

   虽然条件没给全，但是解析都说是用除数留余法，在王道p264页。根据装填因子算出表长N=15后得到P=13，P是不超过N的最大素数，然后就可以算了

### 3 孩子兄弟表示法，递归求结点个数

```c++
typedef struct node {
    int val;
    //兄弟指针 
    Node *bro;
    //孩子指针 
    Node *child;
} Node, *Tree;

//求这棵树的结点个数 
int func(Tree T) {
    if (!T)return 0;
    return func(T->child) + func(T->bro) + 1;
}
```

### 4 递归删除单链表中值为x的算法

之前在王道上面做过。递归函数里面要注意传入的是指针引用，必须是指针引用，否则达不到效果。传入下一层递归的是p->next.在下一层所有对p的操作应当看出是对p->next的操作。

p=p->next的操作相当于p->next=p->next->next; 所以是不会断链的

```c
typedef struct node {
    int val;
    struct node *next;
} Node, *List;

void deleteX(List &p, int x) {
    if (!p)return;
    if (p->val == x) {
        p = p->next;
        deleteX(p, x);
    } else deleteX(p->next, x);
}

//调用
deleteX(L->next,x);

```

### 5 循环生成数

看起来很像大数的题目，但是没给n的范围，不过就算是大数也没这么难。

```c
int func(long long int n) {
    int ans = 0;
    //n/10=0 表示n的范围在0~9，个位数的时候不会产生新数，上一轮已经是最后的结果 
    while (n / 10) {
        int sum = 0;
        int t = 0;
        while (n) {
            t = n % 10;
            sum += t;
            n /= 10;
        }
        ans++;
        n = sum;
    }
    //加上本身
    return ans + 1;
}
```


## OS

### 6 名词解释

1. 寻道时间：磁盘调度时候把磁头旋转到对应磁道所花的时间
2. 动态装入：P149，装入程序把装入模块装入内存后，并不立即把装入模块中的相对地址转换为绝对地址，而是把这种地址转换推迟到程序真正需要时才执行，简而言之就是程序需要的时候才进行地址转换。需要重定位寄存器的支持。
3. 用户态线程：运行在用户态下的线程，一个用户态进程有多个线程，而这些线程对核心态不可见，os分配资源的单位仍然是进程，当该进程中的一个线程阻塞时，会导致该进程阻塞。
4. 内碎片：在内存分配时，供某进程使用的内存块中没有被用到的空间就称为内碎片
5. 临界区:访问临界资源的代码段就称为临界区

### 7 判断正误

1. 对，死锁至少由两个及两个以上进程发生
2. 错，TLB命中时才能减少内存访问时间
3. 错，编程空间的大小取决于硬件的访存能力，一般由地址总线宽度决定
4. 正确，文件目录在外存中，节省空间
5. 错，某个进程从等待到就绪并不影响当前处理机处理的进程状态

### 8 cpu利用率为3%，磁盘I/O利用率为97%，其它I/O利用率是5%，问以下措施能否提高系统的利用率：

1. 不能，当前CPU利用率低，CPU速度提高不能提高系统的利用率，操作系统反而会因为当前的CPU利用率低而增加进程，导致更频繁的抖动
2. 可以，撤销进程能减少当前系统的缺页率，避免频繁的调入调出
3. 可以，增加内存能够增加每个程序的页面，降低缺页率
4. 不可以，当前系统在频繁的调入调出，说明是内存空间不足，增大磁盘空间不能提高效率
5. 不可以，当前的问题是频繁缺页，提高磁盘速度并不能提高CPU的利用率

王道P196页选择题有详细解释

### 9 分页管理大题

一级页表，TLB 10ns，命中率98%，内存 100ns，置换 200ns

1. $10+100$，TLB命中的页一定在内存中，使用TLB时间加访存时间即可

2. $10+100+100$，访TLB，访页表，访问内存

3. **王道版本**：$0.98*(10+100)+0.02*(10+100+200+10+100)=116.2$

   TLB，页表，发现对应页不在内存中，置换，重新开始访问快表，访问内存。

   **MOOC版本**：$0.98*(10+100)+0.02*(10+100+200+100)=116$

   TLB，页表，发现对应页不在内存中，置换，直接访问内存。

   补充：

   设p为页表不命中的概率

   **王道版标准计算公式为**

   $0.98*(10+100)+0.02*(10+100+p200+p10+100)$

   0.98这个是情况1，快表命中
   0.02是快表不命中的情况，此时我们可以根据快表不命中，页表是否命中来划分两种访问情况
   那么
   1) 页表命中的概率是1-p，此时的访问时间为(1-p)\*(10+100+100)
   2) 页表不命中的概率是p，此时的访问时间为p\*(10+100+200+10+100)
   合并上述两个式子得
   10+100+p200+p10+100

   **MOOC版标准计算公式为**

   $0.98*(10+100)+0.02*(10+100+p200+100)$

   我们设页表不命中的概率是p，那么
   1) 页表命中的概率是1-p，此时的访问时间为(1-p)\*(10+100+100)
   2) 页表不命中的概率是p，此时的访问时间为p\*(10+100+200+100)




### 10 目录大题

目录的作用，目录组织形式，举例说明通过文件名在目录查找中查找到文件的创建日期

答：目录是一种数据结构，用于标识系统中的文件及其物理地址，文件目录存放着文件的基本信息，通过文件可以实现按名存取；目录组织形式有单级目录，二级目录，树形目录，无环图目录。

用户输入文件名，操作系统根据文件名在当前目录中查找文件，文件目录中有多个FCB(文件控制块，P221)，其中存放着文件名，位置，大小，日期等信息，当匹配到文件名的时候，就可以得到该文件的FCB，进而得到文件的日期信息。

## 总结

文件的逻辑结构，目录结构，文件

分配（理解为文件的存放更形象），文件存储空间

文件的逻辑结构是文件内部的结构。文件按照类型分为非流式文件，结构文件。其中结构文件又分为顺序文件，索引文件，索引顺序文件。顺序文件可以实现随机存储，但是需要连续的存储空间，索引文件通过使用索引表可以实现随机存取，同时不需要连续的存储空间，索引顺序文件是先将文件按组分配，然后再按索引分配，从而提高检索速度

文件的目录结构上面提到了

文件分配分为连续分配，链接分配（隐式链接磁盘块头尾相连，显示链接建立FAT），索引分配（一级，多级，混合索引）

文件存储空间：空闲表法（注意增加删除可能有的合并操作）空闲链表法（盘块，盘区),位视图法，成组链接法

