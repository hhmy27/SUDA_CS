[toc]

# 10 文件系统接口

## 测验

![QQ图片20201106211458](MdAsset/10 文件系统接口/QQ图片20201106211458.png)

树形目录不能实现文件共享，只有图型目录可以

![15  (55}) iËfi.  D. ](MdAsset/10 文件系统接口/clip_image001-1603976110818.png)

不存在按用户名方式访问

![12  囗  0 《 （ 5 分 ） 哕 辑 文 僻 的 访 问 方 式 有 0 ·  A. 间 接 访 问  & 顺 序 访 问  C 、 直 接 访 问  D. 随 机 访 问  正 答 就 B 、 C 、  D 你 措 选 为 3 、 D ](MdAsset/10 文件系统接口/clip_image001-1603976116149.png)

没有间接访问方式

![5  0  0  0  《 单 选 （ 5 分 ） 不 浪 费 存 储 空 间 的 逻 文 件 组 织 方 式 是 0 ．  A. 随 机 文 件  B. 索 引 文 件  0 直 接 文 件  D. 顺 序 文 件  庄 确 答 宰 ： D 赭 选 为 8 ](MdAsset/10 文件系统接口/clip_image001-1603976146397.png)

不存在随机文件
索引文件有索引表，会浪费空间
直接文件按照最大记录长度存储每一条记录，是最浪费空间的存储方式
顺序文件是直接存放，不支持随机访问，但是最节省空间

## 作业

![一 个 文 件 系 统 的 每 个 目 录 文 件 最 多 存 放 40 个 下 级 文 件 （ 目 录 文 件 或 普 通 文 件 ） ， 每 个 物 理 块 可 以  存 放 10 个 目 录 项 ． 若 下 级 文 件 为 目 录 文 件 ， 上 级 目 录 指 向 该 目 录 文 件 的 第 一 块 ， 否 则 指 向 普 通 文  件 的 文 件 控 制 块 ． 请 问 ：  1) 如 果 采 用 单 级 目 录 ， 查 找 一 个 文 件 最 多 和 最 少 需 要 读 入 多 少 个 物 理 块 ？  2 ） 如 果 采 用 二 级 目 录 ， 查 找 一 个 文 件 最 多 和 最 少 需 要 读 入 多 少 个 物 理 块 ？ ](MdAsset/10 文件系统接口/clip_image001-1603976217688.png)

**答案：**

- 单级目录：
            40个下级文件，一共4个物理块
            最少读入一个就能找到文件的目录项
            最多读入4块
- 二级目录：
            最少的情况读入第一块目录，然后里面就有目标文件的FCB，读入一块即可
            最多的情况，一级目录全都存放目录文件，指向40个目录，40个目录都存满了文件，一共40*40=1600个文件

最多的情况是在二级目录的最后一个物理块找到，所以一共要读入4+160块，共164块

**官方答案：**

![image-20201029205711121](MdAsset/10 文件系统接口/image-20201029205711121.png)

---

![2  （ 20 分 ） 在 I-Jmx 系 统 的 文 件 系 统 中 引 入 黠 点 的 目 的 是 什 么 ？ 请 举 例 说 明 、 ](MdAsset/10 文件系统接口/clip_image001-1603976236546.png)

**官方答案：**

![image-20201029205725388](MdAsset/10 文件系统接口/image-20201029205725388.png)

与PPT上的例子类似

![例 子  物 理 块 大 小 为 4KB  ※ 某 个 目 录 中 有 1 万 个 文 件 ， 每 个 文 件 的 FCB （ 目 录 项 ） 大  小 为 2KB ， 则  目 录 文 件 大 小 ： 20000KB  三 0 、 、 00000 、 、 ： 00000  检 索 文 件 平 均 需 要 访 问 的 物 理 块 数 ： （ 5000 + 1 ） / 2 ： 2500 · 5  i node ： 64B  目 录 文 件 大 小 ： 640000B = 625KB  1 / 32  检 索 文 件 平 均 需 要 访 问 的 物 理 块 数 ： （ 157 + 1 ） / 2 ：  79 ](MdAsset/10 文件系统接口/clip_image001-1603976254447.png)

---

![3  （ 20 分 ） 请 谈 谈 Wind 。 ws 中 采 用 符 号 谦 接 壓 和 优 点 · ](MdAsset/10 文件系统接口/clip_image001-1603976258244.png)

**答案：**

符号链接是软链接的一种，为每个共享文件的用户创造一个LINK类型的新文件，LINK文件存放的是该文件的实际路径，每次访问LINK的时候系统根据LINK文件访问路径找到对应文件访问。
优点：可以连接任意文件、目录，占用空间小
缺点：当目标文件移动时，软连接就失效了

扩展：
硬连接，建立文件的索引结点，共享文件的用户的目录中指向这个索引结点，当用户需要访问共享文件的时候，通过索引结点找到该文件。同时索引结点存有一个计数器，计数器的值是当前共享该文件的用户，当计数器为0的时候会删除该文件

**官方答案：**

![image-20201029205759930](MdAsset/10 文件系统接口/image-20201029205759930.png)

---

![4  （ 20 分 ） 请 举 例 说 明 什 么 的 文 件 采 用 顺 序 文 件 4 子 ， 什 么 文 件 采 用 直 接 文 件 4 子 ？ 为 什 么 ？ ](MdAsset/10 文件系统接口/clip_image001-1603976285315.png)

**官方答案：**

顺序文件:
由一系列记录按照某种顺序排列形成，其中的记录通常是定长记录，因而能够用较快的速度查找文件中的记录，适用于对诸记录批量存取，即每次要读或写一大批记录，比如处理工资单，也只有顺序文件才能存储在磁带上，并能有效的工作。

直接文件:
是在直接存取存储设备上，记录的关键字与其地址之间可以通过某种方式建立对应关系，利用这种关系实现存取的文件。这种存储结构是通过指定记录在介质上的位置进行直接存取的，记录无所谓次序。此外，这种存储结构又不需要索引，节省了索引存储空间和索引查找时间。
**这种存储结构用在不能采用顺序组织方法、次序较乱、又需在极短时间内存取的场合，比如对于实时处理文件、操作系统目录文件、编译程序变量名表等特别有效。**

**扩展：**

逻辑文件分类：顺序文件，直接文件，索引文件
顺序文件适合大文件，不需要随机访问
直接文件适合需要直接访问并且对速度要求高的场景
索引文件一般情况下是最佳的选择，除非题目暗示要选顺序、直接文件（例如题目中出现 大文件、依次读写，对访问速度要求高等关键字）

---

![5  （ 20 分 ） 在 树 型 目 录 中 ， 是 不 是 目 录 层 次 越 多 越 好 ？ 为 什 么 ？ 请 举 例 说 明 、 ](MdAsset/10 文件系统接口/clip_image001-1603976310462.png)

**答案：**

不是，如果目录层次多不便于查找文件，如下所示，查找一个文件需要读入多个物理块

![性 能 对 比 ( 查 找 史 件 first 为 例 丿  目 录 项 ： 占 1 个 物 理 块  root  bin  目 录 文 件 目 录 项  平 均 读 入 块 数  spell  0  ma'  0 紂 对  munt  hex  Sht  spell  mail  （ 1 + 7 ） / 2 一  一 4  O  mail  （ 1 + 4 ） / 2  = 2 ． 5  fi rst  （ 1 + 2 ） / 2  = 1 ． 5  当 目 發  P  exp  绝 对 路 径  从 根 目 录 开 始 到 文 件  三 00 、 一 0  相 对 路 径 、 /pWfirst  读 入 4 + 2 ． 5 + 1 ． 5 = 8 个 物 理 块  对 路 径 ： /spell/mail/prt/first  · 相 对 路 径  当 前 目 录 在 内 存  “ 读 入 1 ． 5 个 物 理 块  8 ](MdAsset/10 文件系统接口/clip_image001-1603976316788.png)

**官方答案：**

![image-20201029205845404](MdAsset/10 文件系统接口/image-20201029205845404.png)