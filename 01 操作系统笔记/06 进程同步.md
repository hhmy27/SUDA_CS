[toc]

# 06 进程同步

## 测验

![2 单 选 （ 5 分 ） 访 司 临 界 区 过 程 中 ， 在 临 界 区 前 的 进 入 区 应 该 实 现 0 准 则 ·  O A 互 戽  O c. 有 限 等 待  确 笞 幸 ： A 你 摺 选 为 日 ](MdAsset/06 进程同步/clip_image001.png)

问的是进入区，应该实现互斥准则

![3  0  O  选 （ 5 分 ） 存 在 忙 等 的 售 号 量 是 0 。  A. AND 亻 号 畢  C. 二 值 信 号 量  正 案 ： D 你 选 对 了 ](MdAsset/06 进程同步/clip_image001-1603973826110.png)

**AND型信号量**

上述的进程互斥问题，是针对各进程之间只共享一个临界资源而言的。在有些应用场合，是一个进程需要先获得两个或更多的共享资源后方能执行其任务。假定现有两个进程A和B，他们都要求访问共享数据D和E。当然，共享数据都应作为临界资源。为此，可为这两个数据分别设置用于互斥的信号量Dmutex和Emutex，并令它们的初值都是1;

**AND同步机制**的基本思想是：将进程在整个运行过程中需要的所有资源，一次性全部地分配给进程，待进程使用完后再一起释放。只要尚有一个资源未能分配给进程，其它所有可能为之分配的资源也不分配给它。亦即，对若干个临界资源的分配，采取原子操作方式：要么把它所请求的资源全部分配到进程，要么一个也不分配。由死锁理论可知，这样就可避免上述死锁情况的发生。为此，在wait操作中，增加了一个“AND”条件，故称为AND同步，或称为同时wait操作

**二进制信号量(binary semaphore)：**

​    只允许信号量取0或1值，其同时只能被一个线程获取。

二值型信号量就是书上的pv(mutex)

![13  囗  《 巛 5 分 ） 以 下 防 止 5 个 哲 学 家 就 餐 出 现 死 迅 解 决 方 氵 去 ， 正 0 0 ·  A. 增 加 ． 一 根 额 筷 子  B. 最 多 允 许 4 个 哲 学 家 同 时 坐 在 臬 子 周 围  c. 给 所 有 皙 学 家 编 嬲 奇 数 号 哲 学 家 霓 颜 首 先 皇 左 边 筷 子 ， 偶 数 号 哲 学 家 则 反 之  D. 仅 当 一 一 个 哲 学 家 左 右 两 边 筷 了 都 可 用 时 ， 才 允 许 他 皇 筷 了  让 晦 答 案 ： A 、 B 、 C 、 D 你 错 选 为 趴 以 D ](MdAsset/06 进程同步/clip_image001-1603973885967.png)

四种方法

第一种破坏循环等待，第四种破坏请求并保持

## 作业

![image-20201029201824898](MdAsset/06 进程同步/image-20201029201824898.png)

**官方答案：**

临界区：
访问临界资源的那段代码。

准则：

- 互斥，如果有进程在某个临界区执行，其他进程将被排斥在临界区外，有相同临界资源的临界区都需要互斥，无相同临界资源的临界区不需要互斥。

- 有空让进，临界区内无进程执行，不能无限期地延长下一个要进入临界区的进程的等待时间。

- 有限等待，每个进程进入临界区前的等待时间必须有限，不能无限等待。

  ---

![image-20201029201840499](MdAsset/06 进程同步/image-20201029201840499.png)

**答案：**

1. 大于0表示该资源剩余的数量
2. 等于0表示该资源刚好分配完
3. 小于0时，其绝对值的意思是正在等待该资源的进程数

---

![image-20201029201854984](MdAsset/06 进程同步/image-20201029201854984.png)

真题考察过，重视

![int Count=O;  repeat  P(SI)  Send message  P(MUTEX)  Count—O  V(S2)  V(S3)  V(S4)  V (MUTEX)  until false  repeat  P(S2)  get message  P(MUTEX)  CountzCount+1  V(SI)  V(MUTEX)  until false  P(S3)  get message  P(MUTEX)  Count=Count41  V(SI)  V(MUTEX)  until false  get message  P(MUTEX)  CountzCount+1  V(SI)  V(MUTEX)  until false ](MdAsset/06 进程同步/clip_image001-1603973943947.png)

---

![image-20201029201911351](MdAsset/06 进程同步/image-20201029201911351.png)

![应 设 置 3 个 信 号 量 ： empty, apple,orangeo 其 中 erbpty 表 示 盘 中 是 否 为 空 ， 初 始 值 为 1 ：  apple 表 示  盘 中 是 否 有 苹 果 ， 初 始 值 为 0 ； 。 range 表 示 盘 中 是 否 有 桔 子 ， 初 始 值 为 0 。 爸 爸 、 妈 妈 、 丿 L 子 和 女 儿  之 间 的 同 步 描 述 如 下 、 Father:  while(ture)  P(empty),  将 苹 果 放 入 盘 中 ，  V(apple),  Mather ：  while(ture)  P(empty),  将 橘 子 放 入 盘 中 ，  V(orange),  Son:  whlle(ture)  P(orange) ：  从 盘 中 取 出 橘 子 吃 掉  V(empty) ：  Daughter:  while(ture)  P(apple),  从 盘 中 取 出 苹 果 吃 掉  V(empty), ](MdAsset/06 进程同步/clip_image001.jpg)

